<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Inventory Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .table-container {
            overflow-x: auto;
            max-height: 70vh;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 15px 8px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px 8px;
            border-bottom: 1px solid #f1f3f4;
            font-size: 13px;
        }

        tr:hover {
            background-color: #f8f9ff;
        }

        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #fff3cd;
            color: #856404;
        }

        .status-out-of-order {
            background: #f8d7da;
            color: #721c24;
        }

        .status-maintenance {
            background: #d1ecf1;
            color: #0c5460;
        }

        .priority-high {
            color: #dc3545;
            font-weight: bold;
        }

        .priority-medium {
            color: #ffc107;
            font-weight: bold;
        }

        .priority-low {
            color: #28a745;
            font-weight: bold;
        }

        .stats {
            padding: 20px 30px;
            background: #f8f9fa;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 14px;
        }

        .export-info {
            padding: 20px 30px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            margin: 20px 30px;
            border-radius: 0 8px 8px 0;
        }

        .export-info h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .field-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .field-item {
            background: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 13px;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                justify-content: space-between;
            }
            
            th, td {
                padding: 8px 4px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>IT Asset Inventory Management</h1>
            <p>Comprehensive tracking system for IT department assets and equipment</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" style="color: #28a745;" id="activeCount">0</div>
                <div class="stat-label">Active Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #ffc107;" id="inactiveCount">0</div>
                <div class="stat-label">Inactive Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #dc3545;" id="outOfOrderCount">0</div>
                <div class="stat-label">Out of Order</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #17a2b8;" id="maintenanceCount">0</div>
                <div class="stat-label">Under Maintenance</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="addSampleData()">Load Sample Data</button>
            <button class="btn btn-success" onclick="exportToCSV()">Export to CSV</button>
            
            <div style="border-left: 2px solid #ddd; padding-left: 15px; margin-left: 10px;">
                <button class="btn btn-primary" onclick="showAddItemModal()" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                    ‚ûï Add New Item
                </button>
                <button class="btn btn-primary" onclick="showServiceModal()" style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);">
                    üîß Send for Servicing
                </button>
                <button class="btn btn-primary" onclick="showRemoveModal()" style="background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);">
                    üóëÔ∏è Remove Item
                </button>
            </div>
            
            <div class="filter-group">
                <label>Filter by Status:</label>
                <select id="statusFilter" onchange="filterTable()">
                    <option value="">All Status</option>
                    <option value="ACTIVE">Active</option>
                    <option value="INACTIVE">Inactive</option>
                    <option value="OUT OF ORDER">Out of Order</option>
                    <option value="MAINTENANCE">Maintenance</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>Filter by Category:</label>
                <select id="categoryFilter" onchange="filterTable()">
                    <option value="">All Categories</option>
                    <option value="Desktop">Desktop</option>
                    <option value="Laptop">Laptop</option>
                    <option value="Server">Server</option>
                    <option value="Network">Network</option>
                    <option value="Printer">Printer</option>
                    <option value="Monitor">Monitor</option>
                    <option value="Mobile">Mobile</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>Search:</label>
                <input type="text" id="searchInput" placeholder="Search assets..." onkeyup="filterTable()">
            </div>
        </div>

        <div class="table-container">
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th>Asset ID</th>
                        <th>Asset Name</th>
                        <th>Category</th>
                        <th>Brand/Make</th>
                        <th>Model</th>
                        <th>Serial Number</th>
                        <th>Status</th>
                        <th>Location</th>
                        <th>Assigned To</th>
                        <th>Department</th>
                        <th>Purchase Date</th>
                        <th>Purchase Price</th>
                        <th>Warranty Expiry</th>
                        <th>Last Maintenance</th>
                        <th>Priority</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody id="inventoryBody">
                    <!-- Data will be populated here -->
                </tbody>
            </table>
        </div>

        <div class="export-info">
            <h3>Excel/CSV Format Fields Included:</h3>
            <p>This inventory format includes all essential fields for comprehensive IT asset management:</p>
            <div class="field-list">
                <div class="field-item">Asset ID (Unique Identifier)</div>
                <div class="field-item">Asset Name</div>
                <div class="field-item">Category/Type</div>
                <div class="field-item">Brand/Manufacturer</div>
                <div class="field-item">Model Number</div>
                <div class="field-item">Serial Number</div>
                <div class="field-item">Status (Active/Inactive/Out of Order/Maintenance)</div>
                <div class="field-item">Physical Location</div>
                <div class="field-item">Assigned User</div>
                <div class="field-item">Department</div>
                <div class="field-item">Purchase Date</div>
                <div class="field-item">Purchase Price</div>
                <div class="field-item">Warranty Expiry Date</div>
                <div class="field-item">Last Maintenance Date</div>
                <div class="field-item">Priority Level</div>
                <div class="field-item">Additional Notes</div>
            </div>
        </div>
    </div>

    <script>
        let inventoryData = [];
        let filteredData = [];

        const sampleData = [
            {
                assetId: 'IT-001',
                assetName: 'Dell OptiPlex 7090',
                category: 'Desktop',
                brand: 'Dell',
                model: 'OptiPlex 7090',
                serialNumber: 'DL789456123',
                status: 'ACTIVE',
                location: 'Office Floor 2, Desk 25',
                assignedTo: 'John Smith',
                department: 'Finance',
                purchaseDate: '2023-01-15',
                purchasePrice: '$1,200',
                warrantyExpiry: '2026-01-15',
                lastMaintenance: '2024-11-20',
                priority: 'Medium',
                notes: 'Upgraded RAM to 16GB'
            },
            {
                assetId: 'IT-002',
                assetName: 'HP EliteBook 840',
                category: 'Laptop',
                brand: 'HP',
                model: 'EliteBook 840 G8',
                serialNumber: 'HP234567890',
                status: 'ACTIVE',
                location: 'Remote - Employee Home',
                assignedTo: 'Sarah Johnson',
                department: 'Marketing',
                purchaseDate: '2023-03-10',
                purchasePrice: '$1,500',
                warrantyExpiry: '2026-03-10',
                lastMaintenance: '2024-10-15',
                priority: 'High',
                notes: 'Mobile workstation for remote work'
            },
            {
                assetId: 'IT-003',
                assetName: 'Cisco Catalyst 2960',
                category: 'Network',
                brand: 'Cisco',
                model: 'Catalyst 2960-X',
                serialNumber: 'CS456789012',
                status: 'OUT OF ORDER',
                location: 'Server Room A, Rack 5',
                assignedTo: 'Network Team',
                department: 'IT',
                purchaseDate: '2022-06-20',
                purchasePrice: '$800',
                warrantyExpiry: '2025-06-20',
                lastMaintenance: '2024-12-01',
                priority: 'High',
                notes: 'Port 12-24 not functioning, replacement ordered'
            },
            {
                assetId: 'IT-004',
                assetName: 'Canon ImageRUNNER',
                category: 'Printer',
                brand: 'Canon',
                model: 'imageRUNNER ADVANCE C5535i',
                serialNumber: 'CN789012345',
                status: 'MAINTENANCE',
                location: 'Office Floor 1, Copy Center',
                assignedTo: 'General Use',
                department: 'General',
                purchaseDate: '2023-08-12',
                purchasePrice: '$3,500',
                warrantyExpiry: '2026-08-12',
                lastMaintenance: '2024-12-20',
                priority: 'Medium',
                notes: 'Scheduled maintenance - toner replacement'
            },
            {
                assetId: 'IT-005',
                assetName: 'Dell PowerEdge R740',
                category: 'Server',
                brand: 'Dell',
                model: 'PowerEdge R740',
                serialNumber: 'DL345678901',
                status: 'ACTIVE',
                location: 'Data Center, Rack 12',
                assignedTo: 'Server Team',
                department: 'IT',
                purchaseDate: '2022-11-30',
                purchasePrice: '$8,500',
                warrantyExpiry: '2025-11-30',
                lastMaintenance: '2024-12-10',
                priority: 'High',
                notes: 'Primary database server - critical system'
            },
            {
                assetId: 'IT-006',
                assetName: 'iPad Pro 12.9"',
                category: 'Mobile',
                brand: 'Apple',
                model: 'iPad Pro 12.9" (6th gen)',
                serialNumber: 'AP567890123',
                status: 'INACTIVE',
                location: 'IT Storage Room',
                assignedTo: 'Unassigned',
                department: 'IT',
                purchaseDate: '2023-05-15',
                purchasePrice: '$1,100',
                warrantyExpiry: '2025-05-15',
                lastMaintenance: '2024-09-30',
                priority: 'Low',
                notes: 'Available for assignment - needs setup'
            }
        ];

        function addSampleData() {
            inventoryData = [...sampleData];
            filteredData = [...inventoryData];
            renderTable();
            updateStats();
        }

        function renderTable() {
            const tbody = document.getElementById('inventoryBody');
            tbody.innerHTML = '';

            filteredData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${item.assetId}</strong></td>
                    <td>${item.assetName}</td>
                    <td>${item.category}</td>
                    <td>${item.brand}</td>
                    <td>${item.model}</td>
                    <td>${item.serialNumber}</td>
                    <td><span class="status ${getStatusClass(item.status)}">${item.status}</span></td>
                    <td>${item.location}</td>
                    <td>${item.assignedTo}</td>
                    <td>${item.department}</td>
                    <td>${item.purchaseDate}</td>
                    <td>${item.purchasePrice}</td>
                    <td>${item.warrantyExpiry}</td>
                    <td>${item.lastMaintenance}</td>
                    <td><span class="priority-${item.priority.toLowerCase()}">${item.priority}</span></td>
                    <td>${item.notes}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function getStatusClass(status) {
            switch(status) {
                case 'ACTIVE': return 'status-active';
                case 'INACTIVE': return 'status-inactive';
                case 'OUT OF ORDER': return 'status-out-of-order';
                case 'MAINTENANCE': return 'status-maintenance';
                default: return '';
            }
        }

        function updateStats() {
            const active = inventoryData.filter(item => item.status === 'ACTIVE').length;
            const inactive = inventoryData.filter(item => item.status === 'INACTIVE').length;
            const outOfOrder = inventoryData.filter(item => item.status === 'OUT OF ORDER').length;
            const maintenance = inventoryData.filter(item => item.status === 'MAINTENANCE').length;

            document.getElementById('activeCount').textContent = active;
            document.getElementById('inactiveCount').textContent = inactive;
            document.getElementById('outOfOrderCount').textContent = outOfOrder;
            document.getElementById('maintenanceCount').textContent = maintenance;
        }

        function filterTable() {
            const statusFilter = document.getElementById('statusFilter').value;
            const categoryFilter = document.getElementById('categoryFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            filteredData = inventoryData.filter(item => {
                const matchesStatus = !statusFilter || item.status === statusFilter;
                const matchesCategory = !categoryFilter || item.category === categoryFilter;
                const matchesSearch = !searchTerm || 
                    Object.values(item).some(value => 
                        value.toString().toLowerCase().includes(searchTerm)
                    );

                return matchesStatus && matchesCategory && matchesSearch;
            });

            renderTable();
        }

        function exportToCSV() {
            if (inventoryData.length === 0) {
                alert('Please load sample data first or add your own data.');
                return;
            }

            const headers = [
                'Asset ID', 'Asset Name', 'Category', 'Brand/Make', 'Model', 'Serial Number',
                'Status', 'Location', 'Assigned To', 'Department', 'Purchase Date', 
                'Purchase Price', 'Warranty Expiry', 'Last Maintenance', 'Priority', 'Notes'
            ];

            const csvContent = [
                headers.join(','),
                ...filteredData.map(item => [
                    item.assetId, item.assetName, item.category, item.brand, item.model,
                    item.serialNumber, item.status, item.location, item.assignedTo,
                    item.department, item.purchaseDate, item.purchasePrice,
                    item.warrantyExpiry, item.lastMaintenance, item.priority, item.notes
                ].map(field => `"${field}"`).join(','))
            ].join('\n');

            // Show CSV content in a modal for copying
            showCSVModal(csvContent);
        }

        function showCSVModal(csvContent) {
            // Create modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 30px;
                border-radius: 15px;
                max-width: 90%;
                max-height: 80%;
                overflow: auto;
                position: relative;
            `;

            modalContent.innerHTML = `
                <h2 style="margin-bottom: 15px; color: #2c3e50;">CSV Data Ready for Export</h2>
                <p style="margin-bottom: 15px; color: #666;">Copy the data below and paste it into Excel or save as a .csv file:</p>
                <textarea id="csvTextarea" style="width: 100%; height: 300px; font-family: monospace; font-size: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" readonly>${csvContent}</textarea>
                <div style="margin-top: 15px; display: flex; gap: 10px;">
                    <button onclick="copyCSVData()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">Copy to Clipboard</button>
                    <button onclick="closeModal()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Close</button>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 5px; font-size: 14px;">
                    <strong>How to use:</strong><br>
                    1. Click "Copy to Clipboard" to copy the CSV data<br>
                    2. Open Excel or Google Sheets<br>
                    3. Paste the data (Ctrl+V)<br>
                    4. Save as .xlsx or .csv file
                </div>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);

            // Close modal when clicking outside
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });

            window.currentModal = modal;
        }

        function copyCSVData() {
            const textarea = document.getElementById('csvTextarea');
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                alert('CSV data copied to clipboard! You can now paste it into Excel.');
            } catch (err) {
                alert('Unable to copy automatically. Please select all text and copy manually (Ctrl+C).');
            }
        }

        function closeModal() {
            if (window.currentModal) {
                document.body.removeChild(window.currentModal);
                window.currentModal = null;
            }
        }

        // Add New Item Modal
        function showAddItemModal() {
            const modal = createModal();
            const modalContent = modal.querySelector('.modal-content');
            
            modalContent.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #28a745;">‚ûï Add New Asset</h2>
                <form id="addItemForm" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Asset Name*</label>
                        <input type="text" id="newAssetName" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Category*</label>
                        <select id="newCategory" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                            <option value="">Select Category</option>
                            <option value="Desktop">Desktop</option>
                            <option value="Laptop">Laptop</option>
                            <option value="Server">Server</option>
                            <option value="Network">Network</option>
                            <option value="Printer">Printer</option>
                            <option value="Monitor">Monitor</option>
                            <option value="Mobile">Mobile</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Brand*</label>
                        <input type="text" id="newBrand" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Model*</label>
                        <input type="text" id="newModel" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Serial Number*</label>
                        <input type="text" id="newSerial" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Location*</label>
                        <input type="text" id="newLocation" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Assigned To</label>
                        <input type="text" id="newAssignedTo" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Department*</label>
                        <input type="text" id="newDepartment" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Purchase Date*</label>
                        <input type="date" id="newPurchaseDate" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Purchase Price*</label>
                        <input type="text" id="newPurchasePrice" required placeholder="$1,000" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Warranty Expiry*</label>
                        <input type="date" id="newWarrantyExpiry" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Priority</label>
                        <select id="newPriority" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                            <option value="Low">Low</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="High">High</option>
                        </select>
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Notes</label>
                        <textarea id="newNotes" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; height: 60px;" placeholder="Additional information..."></textarea>
                    </div>
                </form>
                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="addNewItem()" style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Add Asset</button>
                    <button onclick="closeModal()" style="padding: 12px 24px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Cancel</button>
                </div>
            `;
            
            document.body.appendChild(modal);
            window.currentModal = modal;
        }

        // Send for Servicing Modal
        function showServiceModal() {
            if (inventoryData.length === 0) {
                alert('Please load sample data or add items first.');
                return;
            }

            const modal = createModal();
            const modalContent = modal.querySelector('.modal-content');
            
            const activeAssets = inventoryData.filter(item => item.status === 'ACTIVE' || item.status === 'OUT OF ORDER');
            
            modalContent.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #ffc107;">üîß Send Asset for Servicing</h2>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Select Asset to Service:</label>
                    <select id="serviceAssetSelect" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
                        <option value="">Choose an asset...</option>
                        ${activeAssets.map(item => 
                            `<option value="${item.assetId}">${item.assetId} - ${item.assetName} (${item.assignedTo})</option>`
                        ).join('')}
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Service Type:</label>
                    <select id="serviceType" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="Scheduled Maintenance">Scheduled Maintenance</option>
                        <option value="Repair">Repair</option>
                        <option value="Upgrade">Upgrade</option>
                        <option value="Inspection">Inspection</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Service Notes:</label>
                    <textarea id="serviceNotes" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 80px;" placeholder="Describe the service required..."></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="sendForService()" style="padding: 12px 24px; background: #ffc107; color: #000; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Send for Service</button>
                    <button onclick="closeModal()" style="padding: 12px 24px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Cancel</button>
                </div>
            `;
            
            document.body.appendChild(modal);
            window.currentModal = modal;
        }

        // Remove Item Modal
        function showRemoveModal() {
            if (inventoryData.length === 0) {
                alert('Please load sample data or add items first.');
                return;
            }

            const modal = createModal();
            const modalContent = modal.querySelector('.modal-content');
            
            modalContent.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #dc3545;">üóëÔ∏è Remove Asset from Inventory</h2>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Select Asset to Remove:</label>
                    <select id="removeAssetSelect" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
                        <option value="">Choose an asset...</option>
                        ${inventoryData.map(item => 
                            `<option value="${item.assetId}">${item.assetId} - ${item.assetName} (${item.status})</option>`
                        ).join('')}
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Reason for Removal:</label>
                    <select id="removeReason" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="End of Life">End of Life</option>
                        <option value="Sold">Sold</option>
                        <option value="Donated">Donated</option>
                        <option value="Disposed">Disposed</option>
                        <option value="Lost/Stolen">Lost/Stolen</option>
                        <option value="Transfer">Transfer to Another Dept</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">Additional Notes:</label>
                    <textarea id="removeNotes" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 80px;" placeholder="Additional details about removal..."></textarea>
                </div>
                <div style="background: #f8d7da; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #dc3545;">
                    <strong>‚ö†Ô∏è Warning:</strong> This action will permanently remove the asset from your inventory. Make sure to backup your data before proceeding.
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="removeAsset()" style="padding: 12px 24px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Remove Asset</button>
                    <button onclick="closeModal()" style="padding: 12px 24px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Cancel</button>
                </div>
            `;
            
            document.body.appendChild(modal);
            window.currentModal = modal;
        }

        // Helper function to create modal
        function createModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                overflow-y: auto;
            `;

            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.cssText = `
                background: white;
                padding: 30px;
                border-radius: 15px;
                max-width: 800px;
                width: 90%;
                max-height: 90vh;
                overflow-y: auto;
                position: relative;
                margin: 20px;
            `;

            modal.appendChild(modalContent);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                    window.currentModal = null;
                }
            });

            return modal;
        }

        // Add new item function
        function addNewItem() {
            const form = document.getElementById('addItemForm');
            if (!form.checkValidity()) {
                alert('Please fill in all required fields.');
                return;
            }

            const newAssetId = 'IT-' + String(inventoryData.length + 1).padStart(3, '0');
            const today = new Date().toISOString().split('T')[0];

            const newItem = {
                assetId: newAssetId,
                assetName: document.getElementById('newAssetName').value,
                category: document.getElementById('newCategory').value,
                brand: document.getElementById('newBrand').value,
                model: document.getElementById('newModel').value,
                serialNumber: document.getElementById('newSerial').value,
                status: 'ACTIVE',
                location: document.getElementById('newLocation').value,
                assignedTo: document.getElementById('newAssignedTo').value || 'Unassigned',
                department: document.getElementById('newDepartment').value,
                purchaseDate: document.getElementById('newPurchaseDate').value,
                purchasePrice: document.getElementById('newPurchasePrice').value,
                warrantyExpiry: document.getElementById('newWarrantyExpiry').value,
                lastMaintenance: today,
                priority: document.getElementById('newPriority').value,
                notes: document.getElementById('newNotes').value || 'New asset added to inventory'
            };

            inventoryData.push(newItem);
            filteredData = [...inventoryData];
            renderTable();
            updateStats();
            closeModal();
            
            alert(`Asset ${newAssetId} has been successfully added to inventory!`);
        }

        // Send for service function
        function sendForService() {
            const assetId = document.getElementById('serviceAssetSelect').value;
            const serviceType = document.getElementById('serviceType').value;
            const serviceNotes = document.getElementById('serviceNotes').value;

            if (!assetId) {
                alert('Please select an asset to service.');
                return;
            }

            const assetIndex = inventoryData.findIndex(item => item.assetId === assetId);
            if (assetIndex !== -1) {
                inventoryData[assetIndex].status = 'MAINTENANCE';
                inventoryData[assetIndex].lastMaintenance = new Date().toISOString().split('T')[0];
                inventoryData[assetIndex].notes = `${serviceType}: ${serviceNotes || 'Sent for maintenance'}`;
                
                filteredData = [...inventoryData];
                renderTable();
                updateStats();
                closeModal();
                
                alert(`Asset ${assetId} has been sent for ${serviceType.toLowerCase()}!`);
            }
        }

        // Remove asset function
        function removeAsset() {
            const assetId = document.getElementById('removeAssetSelect').value;
            const reason = document.getElementById('removeReason').value;
            const notes = document.getElementById('removeNotes').value;

            if (!assetId) {
                alert('Please select an asset to remove.');
                return;
            }

            if (confirm(`Are you sure you want to remove asset ${assetId}? This action cannot be undone.`)) {
                const assetIndex = inventoryData.findIndex(item => item.assetId === assetId);
                if (assetIndex !== -1) {
                    const removedAsset = inventoryData[assetIndex];
                    inventoryData.splice(assetIndex, 1);
                    
                    // Log removal (in a real system, you'd save this to a separate log)
                    console.log(`Asset Removed: ${assetId} - Reason: ${reason} - Notes: ${notes}`);
                    
                    filteredData = [...inventoryData];
                    renderTable();
                    updateStats();
                    closeModal();
                    
                    alert(`Asset ${assetId} has been removed from inventory. Reason: ${reason}`);
                }
            }
        }

        // Initialize with sample data
        addSampleData();
    </script>
</body>
</html>